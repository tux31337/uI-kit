import { useEffect, useRef } from "react";

type TopViewGraphProps = {
  shotDataList2: any[];
  isAnimation: boolean;
  userDist: string;
};

type ShotGroupCoordinatesProps = {
  xs: number[];
  ys: number[];
};

export const TopViewGraph = ({
  shotDataList2,
  isAnimation = true,
  userDist,
}: TopViewGraphProps) => {
  const svgRef = useRef<SVGSVGElement>(null);
  const svgNS = "http://www.w3.org/2000/svg";

  let userDistance = "meter";

  const shotDataList = [
    {
      trajectoryData: [
        {
          x: 0,
          y: 0,
          z: 0,
        },
        {
          x: 0,
          y: 0,
          z: 0,
        },
        {
          x: 0.054,
          y: 0.277,
          z: 1.57,
        },
        {
          x: 0.108,
          y: 0.552,
          z: 3.13,
        },
        {
          x: 0.162,
          y: 0.826,
          z: 4.682,
        },
        {
          x: 0.215,
          y: 1.098,
          z: 6.224,
        },
        {
          x: 0.268,
          y: 1.369,
          z: 7.758,
        },
        {
          x: 0.321,
          y: 1.638,
          z: 9.282,
        },
        {
          x: 0.372,
          y: 1.906,
          z: 10.798,
        },
        {
          x: 0.424,
          y: 2.172,
          z: 12.305,
        },
        {
          x: 0.474,
          y: 2.437,
          z: 13.803,
        },
        {
          x: 0.525,
          y: 2.701,
          z: 15.292,
        },
        {
          x: 0.575,
          y: 2.963,
          z: 16.773,
        },
        {
          x: 0.624,
          y: 3.224,
          z: 18.245,
        },
        {
          x: 0.673,
          y: 3.483,
          z: 19.709,
        },
        {
          x: 0.722,
          y: 3.742,
          z: 21.165,
        },
        {
          x: 0.77,
          y: 3.999,
          z: 22.613,
        },
        {
          x: 0.817,
          y: 4.254,
          z: 24.052,
        },
        {
          x: 0.864,
          y: 4.509,
          z: 25.483,
        },
        {
          x: 0.911,
          y: 4.762,
          z: 26.906,
        },
        {
          x: 0.957,
          y: 5.014,
          z: 28.321,
        },
        {
          x: 1.003,
          y: 5.265,
          z: 29.729,
        },
        {
          x: 1.048,
          y: 5.515,
          z: 31.128,
        },
        {
          x: 1.093,
          y: 5.764,
          z: 32.52,
        },
        {
          x: 1.138,
          y: 6.011,
          z: 33.904,
        },
        {
          x: 1.182,
          y: 6.258,
          z: 35.28,
        },
        {
          x: 1.225,
          y: 6.503,
          z: 36.649,
        },
        {
          x: 1.268,
          y: 6.747,
          z: 38.01,
        },
        {
          x: 1.311,
          y: 6.99,
          z: 39.364,
        },
        {
          x: 1.353,
          y: 7.232,
          z: 40.711,
        },
        {
          x: 1.395,
          y: 7.473,
          z: 42.05,
        },
        {
          x: 1.437,
          y: 7.713,
          z: 43.382,
        },
        {
          x: 1.478,
          y: 7.951,
          z: 44.707,
        },
        {
          x: 1.519,
          y: 8.189,
          z: 46.025,
        },
        {
          x: 1.559,
          y: 8.425,
          z: 47.335,
        },
        {
          x: 1.599,
          y: 8.661,
          z: 48.639,
        },
        {
          x: 1.638,
          y: 8.895,
          z: 49.936,
        },
        {
          x: 1.677,
          y: 9.128,
          z: 51.226,
        },
        {
          x: 1.716,
          y: 9.361,
          z: 52.509,
        },
        {
          x: 1.754,
          y: 9.592,
          z: 53.785,
        },
        {
          x: 1.792,
          y: 9.822,
          z: 55.055,
        },
        {
          x: 1.83,
          y: 10.051,
          z: 56.318,
        },
        {
          x: 1.867,
          y: 10.279,
          z: 57.574,
        },
        {
          x: 1.904,
          y: 10.506,
          z: 58.824,
        },
        {
          x: 1.94,
          y: 10.731,
          z: 60.067,
        },
        {
          x: 1.976,
          y: 10.956,
          z: 61.304,
        },
        {
          x: 2.012,
          y: 11.18,
          z: 62.535,
        },
        {
          x: 2.047,
          y: 11.402,
          z: 63.759,
        },
        {
          x: 2.082,
          y: 11.624,
          z: 64.977,
        },
        {
          x: 2.117,
          y: 11.844,
          z: 66.189,
        },
        {
          x: 2.151,
          y: 12.064,
          z: 67.395,
        },
        {
          x: 2.185,
          y: 12.282,
          z: 68.594,
        },
        {
          x: 2.218,
          y: 12.499,
          z: 69.788,
        },
        {
          x: 2.251,
          y: 12.715,
          z: 70.975,
        },
        {
          x: 2.284,
          y: 12.93,
          z: 72.157,
        },
        {
          x: 2.317,
          y: 13.144,
          z: 73.333,
        },
        {
          x: 2.349,
          y: 13.357,
          z: 74.502,
        },
        {
          x: 2.381,
          y: 13.568,
          z: 75.666,
        },
        {
          x: 2.412,
          y: 13.779,
          z: 76.824,
        },
        {
          x: 2.443,
          y: 13.988,
          z: 77.977,
        },
        {
          x: 2.474,
          y: 14.197,
          z: 79.124,
        },
        {
          x: 2.505,
          y: 14.404,
          z: 80.265,
        },
        {
          x: 2.535,
          y: 14.61,
          z: 81.4,
        },
        {
          x: 2.565,
          y: 14.814,
          z: 82.53,
        },
        {
          x: 2.594,
          y: 15.018,
          z: 83.655,
        },
        {
          x: 2.623,
          y: 15.221,
          z: 84.774,
        },
        {
          x: 2.652,
          y: 15.422,
          z: 85.888,
        },
        {
          x: 2.681,
          y: 15.622,
          z: 86.996,
        },
        {
          x: 2.709,
          y: 15.821,
          z: 88.099,
        },
        {
          x: 2.737,
          y: 16.019,
          z: 89.197,
        },
        {
          x: 2.765,
          y: 16.215,
          z: 90.29,
        },
        {
          x: 2.792,
          y: 16.411,
          z: 91.377,
        },
        {
          x: 2.819,
          y: 16.605,
          z: 92.459,
        },
        {
          x: 2.846,
          y: 16.798,
          z: 93.536,
        },
        {
          x: 2.872,
          y: 16.989,
          z: 94.608,
        },
        {
          x: 2.899,
          y: 17.18,
          z: 95.675,
        },
        {
          x: 2.924,
          y: 17.369,
          z: 96.737,
        },
        {
          x: 2.95,
          y: 17.557,
          z: 97.794,
        },
        {
          x: 2.975,
          y: 17.744,
          z: 98.847,
        },
        {
          x: 3,
          y: 17.929,
          z: 99.894,
        },
        {
          x: 3.025,
          y: 18.113,
          z: 100.937,
        },
        {
          x: 3.05,
          y: 18.296,
          z: 101.974,
        },
        {
          x: 3.074,
          y: 18.478,
          z: 103.007,
        },
        {
          x: 3.098,
          y: 18.658,
          z: 104.036,
        },
        {
          x: 3.122,
          y: 18.837,
          z: 105.059,
        },
        {
          x: 3.145,
          y: 19.014,
          z: 106.078,
        },
        {
          x: 3.168,
          y: 19.191,
          z: 107.093,
        },
        {
          x: 3.191,
          y: 19.366,
          z: 108.102,
        },
        {
          x: 3.214,
          y: 19.539,
          z: 109.108,
        },
        {
          x: 3.236,
          y: 19.711,
          z: 110.109,
        },
        {
          x: 3.258,
          y: 19.882,
          z: 111.105,
        },
        {
          x: 3.28,
          y: 20.052,
          z: 112.097,
        },
        {
          x: 3.302,
          y: 20.22,
          z: 113.085,
        },
        {
          x: 3.323,
          y: 20.386,
          z: 114.068,
        },
        {
          x: 3.344,
          y: 20.552,
          z: 115.047,
        },
        {
          x: 3.365,
          y: 20.715,
          z: 116.022,
        },
        {
          x: 3.386,
          y: 20.878,
          z: 116.992,
        },
        {
          x: 3.406,
          y: 21.039,
          z: 117.958,
        },
        {
          x: 3.426,
          y: 21.198,
          z: 118.92,
        },
        {
          x: 3.446,
          y: 21.357,
          z: 119.878,
        },
        {
          x: 3.466,
          y: 21.513,
          z: 120.832,
        },
        {
          x: 3.486,
          y: 21.668,
          z: 121.782,
        },
        {
          x: 3.505,
          y: 21.822,
          z: 122.727,
        },
        {
          x: 3.524,
          y: 21.974,
          z: 123.669,
        },
        {
          x: 3.543,
          y: 22.125,
          z: 124.607,
        },
        {
          x: 3.561,
          y: 22.274,
          z: 125.541,
        },
        {
          x: 3.579,
          y: 22.422,
          z: 126.47,
        },
        {
          x: 3.598,
          y: 22.568,
          z: 127.396,
        },
        {
          x: 3.616,
          y: 22.713,
          z: 128.318,
        },
        {
          x: 3.633,
          y: 22.856,
          z: 129.237,
        },
        {
          x: 3.651,
          y: 22.998,
          z: 130.151,
        },
        {
          x: 3.668,
          y: 23.138,
          z: 131.062,
        },
        {
          x: 3.685,
          y: 23.277,
          z: 131.969,
        },
        {
          x: 3.702,
          y: 23.413,
          z: 132.872,
        },
        {
          x: 3.718,
          y: 23.549,
          z: 133.772,
        },
        {
          x: 3.735,
          y: 23.683,
          z: 134.668,
        },
        {
          x: 3.751,
          y: 23.815,
          z: 135.56,
        },
        {
          x: 3.767,
          y: 23.945,
          z: 136.449,
        },
        {
          x: 3.783,
          y: 24.074,
          z: 137.334,
        },
        {
          x: 3.799,
          y: 24.202,
          z: 138.216,
        },
        {
          x: 3.814,
          y: 24.328,
          z: 139.094,
        },
        {
          x: 3.829,
          y: 24.452,
          z: 139.969,
        },
        {
          x: 3.844,
          y: 24.574,
          z: 140.84,
        },
        {
          x: 3.859,
          y: 24.695,
          z: 141.708,
        },
        {
          x: 3.874,
          y: 24.814,
          z: 142.573,
        },
        {
          x: 3.889,
          y: 24.932,
          z: 143.434,
        },
        {
          x: 3.903,
          y: 25.047,
          z: 144.292,
        },
        {
          x: 3.917,
          y: 25.162,
          z: 145.146,
        },
        {
          x: 3.931,
          y: 25.274,
          z: 145.997,
        },
        {
          x: 3.945,
          y: 25.385,
          z: 146.845,
        },
        {
          x: 3.958,
          y: 25.494,
          z: 147.69,
        },
        {
          x: 3.972,
          y: 25.601,
          z: 148.531,
        },
        {
          x: 3.985,
          y: 25.707,
          z: 149.37,
        },
        {
          x: 3.998,
          y: 25.811,
          z: 150.205,
        },
        {
          x: 4.011,
          y: 25.913,
          z: 151.037,
        },
        {
          x: 4.024,
          y: 26.013,
          z: 151.866,
        },
        {
          x: 4.036,
          y: 26.112,
          z: 152.692,
        },
        {
          x: 4.049,
          y: 26.209,
          z: 153.514,
        },
        {
          x: 4.061,
          y: 26.304,
          z: 154.334,
        },
        {
          x: 4.073,
          y: 26.398,
          z: 155.151,
        },
        {
          x: 4.085,
          y: 26.489,
          z: 155.965,
        },
        {
          x: 4.096,
          y: 26.579,
          z: 156.776,
        },
        {
          x: 4.108,
          y: 26.667,
          z: 157.583,
        },
        {
          x: 4.119,
          y: 26.753,
          z: 158.388,
        },
        {
          x: 4.131,
          y: 26.838,
          z: 159.19,
        },
        {
          x: 4.142,
          y: 26.921,
          z: 159.99,
        },
        {
          x: 4.153,
          y: 27.001,
          z: 160.786,
        },
        {
          x: 4.164,
          y: 27.08,
          z: 161.58,
        },
        {
          x: 4.174,
          y: 27.158,
          z: 162.37,
        },
        {
          x: 4.185,
          y: 27.233,
          z: 163.158,
        },
        {
          x: 4.195,
          y: 27.306,
          z: 163.944,
        },
        {
          x: 4.205,
          y: 27.378,
          z: 164.726,
        },
        {
          x: 4.215,
          y: 27.448,
          z: 165.506,
        },
        {
          x: 4.225,
          y: 27.516,
          z: 166.283,
        },
        {
          x: 4.235,
          y: 27.582,
          z: 167.057,
        },
        {
          x: 4.245,
          y: 27.646,
          z: 167.829,
        },
        {
          x: 4.254,
          y: 27.708,
          z: 168.598,
        },
        {
          x: 4.263,
          y: 27.769,
          z: 169.365,
        },
        {
          x: 4.273,
          y: 27.827,
          z: 170.129,
        },
        {
          x: 4.282,
          y: 27.884,
          z: 170.89,
        },
        {
          x: 4.291,
          y: 27.939,
          z: 171.649,
        },
        {
          x: 4.299,
          y: 27.992,
          z: 172.405,
        },
        {
          x: 4.308,
          y: 28.043,
          z: 173.159,
        },
        {
          x: 4.317,
          y: 28.092,
          z: 173.911,
        },
        {
          x: 4.325,
          y: 28.139,
          z: 174.66,
        },
        {
          x: 4.333,
          y: 28.184,
          z: 175.406,
        },
        {
          x: 4.342,
          y: 28.227,
          z: 176.15,
        },
        {
          x: 4.35,
          y: 28.268,
          z: 176.892,
        },
        {
          x: 4.357,
          y: 28.308,
          z: 177.631,
        },
        {
          x: 4.365,
          y: 28.345,
          z: 178.368,
        },
        {
          x: 4.373,
          y: 28.38,
          z: 179.102,
        },
        {
          x: 4.38,
          y: 28.414,
          z: 179.835,
        },
        {
          x: 4.388,
          y: 28.445,
          z: 180.564,
        },
        {
          x: 4.395,
          y: 28.475,
          z: 181.292,
        },
        {
          x: 4.402,
          y: 28.503,
          z: 182.017,
        },
        {
          x: 4.409,
          y: 28.528,
          z: 182.741,
        },
        {
          x: 4.416,
          y: 28.552,
          z: 183.461,
        },
        {
          x: 4.423,
          y: 28.573,
          z: 184.18,
        },
        {
          x: 4.43,
          y: 28.593,
          z: 184.896,
        },
        {
          x: 4.436,
          y: 28.611,
          z: 185.611,
        },
        {
          x: 4.443,
          y: 28.626,
          z: 186.323,
        },
        {
          x: 4.449,
          y: 28.64,
          z: 187.033,
        },
        {
          x: 4.456,
          y: 28.652,
          z: 187.741,
        },
        {
          x: 4.462,
          y: 28.661,
          z: 188.446,
        },
        {
          x: 4.468,
          y: 28.669,
          z: 189.15,
        },
        {
          x: 4.474,
          y: 28.674,
          z: 189.851,
        },
        {
          x: 4.48,
          y: 28.678,
          z: 190.551,
        },
        {
          x: 4.485,
          y: 28.679,
          z: 191.248,
        },
        {
          x: 4.491,
          y: 28.679,
          z: 191.944,
        },
        {
          x: 4.496,
          y: 28.676,
          z: 192.637,
        },
        {
          x: 4.502,
          y: 28.672,
          z: 193.328,
        },
        {
          x: 4.507,
          y: 28.665,
          z: 194.018,
        },
        {
          x: 4.512,
          y: 28.656,
          z: 194.705,
        },
        {
          x: 4.518,
          y: 28.646,
          z: 195.391,
        },
        {
          x: 4.523,
          y: 28.633,
          z: 196.074,
        },
        {
          x: 4.528,
          y: 28.618,
          z: 196.756,
        },
        {
          x: 4.532,
          y: 28.601,
          z: 197.436,
        },
        {
          x: 4.537,
          y: 28.582,
          z: 198.113,
        },
        {
          x: 4.542,
          y: 28.561,
          z: 198.789,
        },
        {
          x: 4.546,
          y: 28.538,
          z: 199.463,
        },
        {
          x: 4.551,
          y: 28.513,
          z: 200.136,
        },
        {
          x: 4.555,
          y: 28.485,
          z: 200.806,
        },
        {
          x: 4.559,
          y: 28.456,
          z: 201.475,
        },
        {
          x: 4.564,
          y: 28.425,
          z: 202.141,
        },
        {
          x: 4.568,
          y: 28.391,
          z: 202.806,
        },
        {
          x: 4.572,
          y: 28.355,
          z: 203.47,
        },
        {
          x: 4.576,
          y: 28.318,
          z: 204.131,
        },
        {
          x: 4.579,
          y: 28.278,
          z: 204.791,
        },
        {
          x: 4.583,
          y: 28.236,
          z: 205.449,
        },
        {
          x: 4.587,
          y: 28.192,
          z: 206.105,
        },
        {
          x: 4.59,
          y: 28.146,
          z: 206.76,
        },
        {
          x: 4.594,
          y: 28.098,
          z: 207.413,
        },
        {
          x: 4.597,
          y: 28.048,
          z: 208.064,
        },
        {
          x: 4.601,
          y: 27.995,
          z: 208.714,
        },
        {
          x: 4.604,
          y: 27.941,
          z: 209.362,
        },
        {
          x: 4.607,
          y: 27.884,
          z: 210.008,
        },
        {
          x: 4.61,
          y: 27.825,
          z: 210.652,
        },
        {
          x: 4.613,
          y: 27.765,
          z: 211.296,
        },
        {
          x: 4.616,
          y: 27.702,
          z: 211.937,
        },
        {
          x: 4.619,
          y: 27.636,
          z: 212.577,
        },
        {
          x: 4.622,
          y: 27.569,
          z: 213.215,
        },
        {
          x: 4.624,
          y: 27.5,
          z: 213.852,
        },
        {
          x: 4.627,
          y: 27.429,
          z: 214.487,
        },
        {
          x: 4.63,
          y: 27.355,
          z: 215.121,
        },
        {
          x: 4.632,
          y: 27.279,
          z: 215.753,
        },
        {
          x: 4.635,
          y: 27.201,
          z: 216.384,
        },
        {
          x: 4.637,
          y: 27.121,
          z: 217.013,
        },
        {
          x: 4.639,
          y: 27.039,
          z: 217.64,
        },
        {
          x: 4.641,
          y: 26.955,
          z: 218.267,
        },
        {
          x: 4.643,
          y: 26.869,
          z: 218.891,
        },
        {
          x: 4.645,
          y: 26.78,
          z: 219.515,
        },
        {
          x: 4.647,
          y: 26.69,
          z: 220.136,
        },
        {
          x: 4.649,
          y: 26.597,
          z: 220.757,
        },
        {
          x: 4.651,
          y: 26.502,
          z: 221.376,
        },
        {
          x: 4.653,
          y: 26.405,
          z: 221.993,
        },
        {
          x: 4.655,
          y: 26.306,
          z: 222.61,
        },
        {
          x: 4.656,
          y: 26.204,
          z: 223.224,
        },
        {
          x: 4.658,
          y: 26.101,
          z: 223.838,
        },
        {
          x: 4.659,
          y: 25.995,
          z: 224.45,
        },
        {
          x: 4.661,
          y: 25.888,
          z: 225.061,
        },
        {
          x: 4.662,
          y: 25.778,
          z: 225.67,
        },
        {
          x: 4.664,
          y: 25.666,
          z: 226.278,
        },
        {
          x: 4.665,
          y: 25.552,
          z: 226.885,
        },
        {
          x: 4.666,
          y: 25.435,
          z: 227.49,
        },
        {
          x: 4.667,
          y: 25.317,
          z: 228.094,
        },
        {
          x: 4.668,
          y: 25.196,
          z: 228.697,
        },
        {
          x: 4.669,
          y: 25.073,
          z: 229.299,
        },
        {
          x: 4.67,
          y: 24.948,
          z: 229.899,
        },
        {
          x: 4.671,
          y: 24.821,
          z: 230.498,
        },
        {
          x: 4.672,
          y: 24.692,
          z: 231.096,
        },
        {
          x: 4.673,
          y: 24.561,
          z: 231.693,
        },
        {
          x: 4.674,
          y: 24.427,
          z: 232.288,
        },
        {
          x: 4.674,
          y: 24.292,
          z: 232.882,
        },
        {
          x: 4.675,
          y: 24.154,
          z: 233.475,
        },
        {
          x: 4.675,
          y: 24.014,
          z: 234.067,
        },
        {
          x: 4.676,
          y: 23.872,
          z: 234.657,
        },
        {
          x: 4.676,
          y: 23.728,
          z: 235.247,
        },
        {
          x: 4.677,
          y: 23.581,
          z: 235.835,
        },
        {
          x: 4.677,
          y: 23.433,
          z: 236.422,
        },
        {
          x: 4.677,
          y: 23.282,
          z: 237.008,
        },
        {
          x: 4.678,
          y: 23.129,
          z: 237.593,
        },
        {
          x: 4.678,
          y: 22.974,
          z: 238.176,
        },
        {
          x: 4.678,
          y: 22.817,
          z: 238.759,
        },
        {
          x: 4.678,
          y: 22.658,
          z: 239.34,
        },
        {
          x: 4.678,
          y: 22.497,
          z: 239.921,
        },
        {
          x: 4.678,
          y: 22.333,
          z: 240.5,
        },
        {
          x: 4.678,
          y: 22.167,
          z: 241.078,
        },
        {
          x: 4.678,
          y: 22,
          z: 241.655,
        },
        {
          x: 4.678,
          y: 21.83,
          z: 242.231,
        },
        {
          x: 4.678,
          y: 21.658,
          z: 242.806,
        },
        {
          x: 4.677,
          y: 21.483,
          z: 243.38,
        },
        {
          x: 4.677,
          y: 21.307,
          z: 243.953,
        },
        {
          x: 4.677,
          y: 21.129,
          z: 244.525,
        },
        {
          x: 4.676,
          y: 20.948,
          z: 245.095,
        },
        {
          x: 4.676,
          y: 20.765,
          z: 245.665,
        },
        {
          x: 4.675,
          y: 20.58,
          z: 246.234,
        },
        {
          x: 4.675,
          y: 20.393,
          z: 246.802,
        },
        {
          x: 4.674,
          y: 20.204,
          z: 247.369,
        },
        {
          x: 4.674,
          y: 20.013,
          z: 247.934,
        },
        {
          x: 4.673,
          y: 19.819,
          z: 248.499,
        },
        {
          x: 4.672,
          y: 19.624,
          z: 249.063,
        },
        {
          x: 4.672,
          y: 19.426,
          z: 249.626,
        },
        {
          x: 4.671,
          y: 19.226,
          z: 250.188,
        },
        {
          x: 4.67,
          y: 19.024,
          z: 250.749,
        },
        {
          x: 4.669,
          y: 18.82,
          z: 251.309,
        },
        {
          x: 4.668,
          y: 18.614,
          z: 251.868,
        },
        {
          x: 4.667,
          y: 18.406,
          z: 252.427,
        },
        {
          x: 4.666,
          y: 18.196,
          z: 252.984,
        },
        {
          x: 4.665,
          y: 17.983,
          z: 253.54,
        },
        {
          x: 4.664,
          y: 17.769,
          z: 254.096,
        },
        {
          x: 4.663,
          y: 17.552,
          z: 254.651,
        },
        {
          x: 4.662,
          y: 17.333,
          z: 255.204,
        },
        {
          x: 4.661,
          y: 17.112,
          z: 255.757,
        },
        {
          x: 4.66,
          y: 16.889,
          z: 256.309,
        },
        {
          x: 4.658,
          y: 16.664,
          z: 256.86,
        },
        {
          x: 4.657,
          y: 16.437,
          z: 257.411,
        },
        {
          x: 4.656,
          y: 16.207,
          z: 257.96,
        },
        {
          x: 4.654,
          y: 15.976,
          z: 258.509,
        },
        {
          x: 4.653,
          y: 15.742,
          z: 259.057,
        },
        {
          x: 4.652,
          y: 15.507,
          z: 259.604,
        },
        {
          x: 4.65,
          y: 15.269,
          z: 260.15,
        },
        {
          x: 4.649,
          y: 15.029,
          z: 260.695,
        },
        {
          x: 4.647,
          y: 14.787,
          z: 261.24,
        },
        {
          x: 4.645,
          y: 14.543,
          z: 261.784,
        },
        {
          x: 4.644,
          y: 14.297,
          z: 262.327,
        },
        {
          x: 4.642,
          y: 14.049,
          z: 262.869,
        },
        {
          x: 4.641,
          y: 13.799,
          z: 263.411,
        },
        {
          x: 4.639,
          y: 13.547,
          z: 263.951,
        },
        {
          x: 4.637,
          y: 13.292,
          z: 264.491,
        },
        {
          x: 4.635,
          y: 13.036,
          z: 265.03,
        },
        {
          x: 4.634,
          y: 12.778,
          z: 265.569,
        },
        {
          x: 4.632,
          y: 12.517,
          z: 266.107,
        },
        {
          x: 4.63,
          y: 12.254,
          z: 266.644,
        },
        {
          x: 4.628,
          y: 11.99,
          z: 267.18,
        },
        {
          x: 4.626,
          y: 11.723,
          z: 267.715,
        },
        {
          x: 4.624,
          y: 11.454,
          z: 268.25,
        },
        {
          x: 4.622,
          y: 11.183,
          z: 268.784,
        },
        {
          x: 4.62,
          y: 10.911,
          z: 269.318,
        },
        {
          x: 4.618,
          y: 10.636,
          z: 269.851,
        },
        {
          x: 4.616,
          y: 10.359,
          z: 270.383,
        },
        {
          x: 4.614,
          y: 10.08,
          z: 270.914,
        },
        {
          x: 4.612,
          y: 9.799,
          z: 271.445,
        },
        {
          x: 4.61,
          y: 9.516,
          z: 271.975,
        },
        {
          x: 4.607,
          y: 9.23,
          z: 272.504,
        },
        {
          x: 4.605,
          y: 8.943,
          z: 273.033,
        },
        {
          x: 4.603,
          y: 8.654,
          z: 273.561,
        },
        {
          x: 4.601,
          y: 8.363,
          z: 274.088,
        },
        {
          x: 4.598,
          y: 8.07,
          z: 274.615,
        },
        {
          x: 4.596,
          y: 7.775,
          z: 275.141,
        },
        {
          x: 4.594,
          y: 7.477,
          z: 275.667,
        },
        {
          x: 4.591,
          y: 7.178,
          z: 276.192,
        },
        {
          x: 4.589,
          y: 6.877,
          z: 276.716,
        },
        {
          x: 4.587,
          y: 6.573,
          z: 277.24,
        },
        {
          x: 4.584,
          y: 6.268,
          z: 277.763,
        },
        {
          x: 4.582,
          y: 5.961,
          z: 278.286,
        },
        {
          x: 4.579,
          y: 5.652,
          z: 278.808,
        },
        {
          x: 4.577,
          y: 5.34,
          z: 279.329,
        },
        {
          x: 4.574,
          y: 5.027,
          z: 279.85,
        },
        {
          x: 4.572,
          y: 4.712,
          z: 280.37,
        },
        {
          x: 4.569,
          y: 4.395,
          z: 280.89,
        },
        {
          x: 4.566,
          y: 4.076,
          z: 281.409,
        },
        {
          x: 4.564,
          y: 3.754,
          z: 281.927,
        },
        {
          x: 4.561,
          y: 3.431,
          z: 282.445,
        },
        {
          x: 4.558,
          y: 3.106,
          z: 282.963,
        },
        {
          x: 4.556,
          y: 2.779,
          z: 283.48,
        },
        {
          x: 4.553,
          y: 2.45,
          z: 283.996,
        },
        {
          x: 4.55,
          y: 2.119,
          z: 284.512,
        },
        {
          x: 4.548,
          y: 1.786,
          z: 285.027,
        },
        {
          x: 4.545,
          y: 1.451,
          z: 285.542,
        },
        {
          x: 4.542,
          y: 1.114,
          z: 286.057,
        },
        {
          x: 4.539,
          y: 0.775,
          z: 286.571,
        },
        {
          x: 4.536,
          y: 0.435,
          z: 287.084,
        },
        {
          x: 4.533,
          y: 0.092,
          z: 287.597,
        },
        {
          x: 4.531,
          y: 0,
          z: 288.109,
        },
        {
          x: 4.530588,
          y: 0,
          z: 288.182281,
        },
        {
          x: 4.527708,
          y: 0,
          z: 288.6944,
        },
        {
          x: 4.524828,
          y: 0.008128803,
          z: 289.2065,
        },
        {
          x: 4.521948,
          y: 0.031307213,
          z: 289.718628,
        },
        {
          x: 4.519068,
          y: 0.05056162,
          z: 290.230743,
        },
        {
          x: 4.51618767,
          y: 0.0658920258,
          z: 290.742859,
        },
        {
          x: 4.51330757,
          y: 0.07729843,
          z: 291.254974,
        },
        {
          x: 4.51042747,
          y: 0.08478084,
          z: 291.7671,
        },
        {
          x: 4.50754738,
          y: 0.08833925,
          z: 292.2792,
        },
        {
          x: 4.50466728,
          y: 0.0879736543,
          z: 292.791321,
        },
        {
          x: 4.501787,
          y: 0.0836840644,
          z: 293.303436,
        },
        {
          x: 4.498907,
          y: 0.07547047,
          z: 293.815552,
        },
        {
          x: 4.496027,
          y: 0.06333288,
          z: 294.327667,
        },
        {
          x: 4.493147,
          y: 0.0472712852,
          z: 294.839783,
        },
        {
          x: 4.490267,
          y: 0.0272856914,
          z: 295.3519,
        },
        {
          x: 4.4873867,
          y: 0.00337609835,
          z: 295.864,
        },
        {
          x: 4.48450661,
          y: 0,
          z: 296.376129,
        },
        {
          x: 4.48162651,
          y: 0,
          z: 296.888245,
        },
        {
          x: 4.4792037,
          y: 0,
          z: 297.319061,
        },
        {
          x: 4.47678041,
          y: 0,
          z: 297.749969,
        },
        {
          x: 4.47439241,
          y: 0,
          z: 298.174622,
        },
        {
          x: 4.47204638,
          y: 0,
          z: 298.591766,
        },
        {
          x: 4.469744,
          y: 0,
          z: 299.001129,
        },
        {
          x: 4.46748638,
          y: 0,
          z: 299.402649,
        },
        {
          x: 4.46527243,
          y: 0,
          z: 299.796326,
        },
        {
          x: 4.463103,
          y: 0,
          z: 300.182159,
        },
        {
          x: 4.460977,
          y: 0,
          z: 300.56012,
        },
        {
          x: 4.45889568,
          y: 0,
          z: 300.930237,
        },
        {
          x: 4.456858,
          y: 0,
          z: 301.2925,
        },
        {
          x: 4.454865,
          y: 0,
          z: 301.646942,
        },
        {
          x: 4.45291567,
          y: 0,
          z: 301.99353,
        },
        {
          x: 4.4510107,
          y: 0,
          z: 302.332275,
        },
        {
          x: 4.44915,
          y: 0,
          z: 302.663177,
        },
        {
          x: 4.44733334,
          y: 0,
          z: 302.9862,
        },
        {
          x: 4.445561,
          y: 0,
          z: 303.3014,
        },
        {
          x: 4.4438324,
          y: 0,
          z: 303.608734,
        },
        {
          x: 4.442148,
          y: 0,
          z: 303.908234,
        },
        {
          x: 4.440508,
          y: 0,
          z: 304.1999,
        },
        {
          x: 4.438912,
          y: 0,
          z: 304.4837,
        },
        {
          x: 4.43736,
          y: 0,
          z: 304.759644,
        },
        {
          x: 4.435852,
          y: 0,
          z: 305.02774,
        },
        {
          x: 4.43438864,
          y: 0,
          z: 305.288,
        },
        {
          x: 4.432969,
          y: 0,
          z: 305.5404,
        },
        {
          x: 4.431594,
          y: 0,
          z: 305.784973,
        },
        {
          x: 4.43026257,
          y: 0,
          z: 306.0217,
        },
        {
          x: 4.42897558,
          y: 0,
          z: 306.250549,
        },
        {
          x: 4.42773247,
          y: 0,
          z: 306.471558,
        },
        {
          x: 4.4265337,
          y: 0,
          z: 306.684723,
        },
        {
          x: 4.425379,
          y: 0,
          z: 306.890045,
        },
        {
          x: 4.42426825,
          y: 0,
          z: 307.087524,
        },
        {
          x: 4.423202,
          y: 0,
          z: 307.277161,
        },
        {
          x: 4.4221797,
          y: 0,
          z: 307.458954,
        },
        {
          x: 4.42120171,
          y: 0,
          z: 307.632874,
        },
        {
          x: 4.42026758,
          y: 0,
          z: 307.79895,
        },
        {
          x: 4.419378,
          y: 0,
          z: 307.957184,
        },
        {
          x: 4.418532,
          y: 0,
          z: 308.107574,
        },
        {
          x: 4.41773033,
          y: 0,
          z: 308.250122,
        },
        {
          x: 4.41697264,
          y: 0,
          z: 308.384827,
        },
        {
          x: 4.41625929,
          y: 0,
          z: 308.511658,
        },
        {
          x: 4.41559029,
          y: 0,
          z: 308.630646,
        },
        {
          x: 4.414965,
          y: 0,
          z: 308.7418,
        },
        {
          x: 4.41438437,
          y: 0,
          z: 308.8451,
        },
        {
          x: 4.41384745,
          y: 0,
          z: 308.940552,
        },
        {
          x: 4.413355,
          y: 0,
          z: 309.028168,
        },
        {
          x: 4.412906,
          y: 0,
          z: 309.1079,
        },
        {
          x: 4.412502,
          y: 0,
          z: 309.1798,
        },
        {
          x: 4.41214132,
          y: 0,
          z: 309.243866,
        },
        {
          x: 4.411825,
          y: 0,
          z: 309.300079,
        },
        {
          x: 4.41155338,
          y: 0,
          z: 309.34845,
        },
        {
          x: 4.41132545,
          y: 0,
          z: 309.388977,
        },
        {
          x: 4.411142,
          y: 0,
          z: 309.421631,
        },
        {
          x: 4.4109993,
          y: 0,
          z: 309.447021,
        },
      ],
    },
  ];

  useEffect(() => {
    const svg = svgRef.current;
    let deltaTime;
    let previousTime = performance.now();
    let raf: number;
    let sumTime = 0;
    const PIXEL_CENTER_START_X = 120;

    let coordinates: any[] = [];

    if (shotDataList.length > 0) {
      coordinates = shotDataList[shotDataList.length - 1].trajectoryData; // meter 데이터를 사용
    }
    const shotGroupCoordinates: ShotGroupCoordinatesProps = { xs: [], ys: [] };

    if (svg) {
      const circles = svg.querySelectorAll(".previous-circle");
      const lastPath = svg.querySelectorAll(".last-path");
      const lastCircle = svg.querySelectorAll(".last-circle");
      const currentCirlce = svg.querySelectorAll(".current-circle");

      circles.forEach((circle) => svg.removeChild(circle));
      lastPath.forEach((path) => svg.removeChild(path));
      lastCircle.forEach((circle) => svg.removeChild(circle));
      currentCirlce.forEach((circle) => svg.removeChild(circle));
    }

    // 이전에 있던 원 좌표 그리는 부분
    if (shotDataList.length > 1) {
      if (svg) {
        const circleCoordinateList = [];

        for (let i = 0; i < shotDataList.length; i++) {
          const trajectoryData =
            userDistance === "yard"
              ? shotDataList[i].trajectoryYardData // yard 데이터
              : shotDataList[i].trajectoryData; // meter 데이터

          if (i < shotDataList.length - 1) {
            circleCoordinateList.push({
              x: trajectoryData[trajectoryData.length - 1].x,
              z: trajectoryData[trajectoryData.length - 1].z,
            });
          }

          shotGroupCoordinates.xs.push(
            trajectoryData[trajectoryData.length - 1].x + 120
          );
          shotGroupCoordinates.ys.push(
            240 - trajectoryData[trajectoryData.length - 1].z * 0.5775
          );
        }

        circleCoordinateList.map((circleCoordinate) => {
          const circle = document.createElementNS(svgNS, "circle");
          const lastX = circleCoordinate.x + PIXEL_CENTER_START_X;
          const lastY = 240 - circleCoordinate.z * 0.5775;
          const radius = 5;

          circle.setAttribute("cx", lastX.toString());
          circle.setAttribute("cy", lastY.toString());
          circle.setAttribute("r", radius.toString());
          circle.setAttribute("fill", "rgb(255, 255, 255)");
          circle.setAttribute("stroke", "rgba(0, 0, 0, 0.75)");
          circle.setAttribute("stroke-width", "1.5");
          circle.classList.add("previous-circle");

          svg.appendChild(circle);
        });
      }
    }

    const startAnimation = (timestamp?: number) => {
      const startTime = performance.now();
      previousTime = startTime;
      animate(startTime);
    };

    const animate = (currentTime: number) => {
      if (previousTime === 0) {
        previousTime = currentTime;
      }

      deltaTime = (currentTime - previousTime) / 1000; // 초로 바꾸기
      previousTime = currentTime;
      sumTime += deltaTime;

      const index = Math.max(2, Math.ceil(sumTime / 0.02));

      if (svg) {
        //path 만 즉 라인을 제거
        const paths = svg.querySelectorAll("path");
        const circles = svg.querySelectorAll(".current-circle");
        const ellipses = svg.querySelectorAll("ellipse");

        paths.forEach((path) => svg.removeChild(path));
        circles.forEach((circle) => svg.removeChild(circle));
        ellipses.forEach((ellipse) => svg.removeChild(ellipse));
        // 그래프를 그리는 로직
        const path = document.createElementNS(svgNS, "path");
        let pathData = "";

        for (
          let i = 0;
          i < (index > coordinates.length ? coordinates.length : index);
          i++
        ) {
          const x = coordinates[i].x + PIXEL_CENTER_START_X;
          const y = 240 - coordinates[i].z * 0.5775;

          if (i === 0) {
            pathData += `M ${x},${y} `;
          } else {
            pathData += `L ${x},${y} `;
          }
        }

        // path.setAttribute("d", pathData);
        // path.setAttribute("stroke", "rgb(255, 221, 0)");
        // path.setAttribute("stroke-width", "2");
        // path.setAttribute("fill", "none");
        // svg.appendChild(path);

        const circle = document.createElementNS(svgNS, "circle");
        const lastX =
          index <= coordinates.length
            ? coordinates[index - 1].x + PIXEL_CENTER_START_X
            : coordinates[coordinates.length - 1].x + PIXEL_CENTER_START_X;

        const lastY =
          index <= coordinates.length
            ? 240 - coordinates[index - 1].z * 0.5775
            : 240 - coordinates[coordinates.length - 1].z * 0.5775;

        const radius = 5;

        circle.setAttribute("cx", lastX.toString());
        circle.setAttribute("cy", lastY.toString());
        circle.setAttribute("r", radius.toString());
        circle.setAttribute("fill", "rgb(255, 221, 0)");
        circle.setAttribute("stroke", "rgba(0, 0, 0, 0.75)");
        circle.setAttribute("stroke-width", "1.5");
        circle.classList.add("current-circle");
        svg.appendChild(circle);
      }

      if (index < coordinates.length) {
        raf = requestAnimationFrame(animate); // 다음 프레임 요청
      }
    };

    if (coordinates.length > 0 && isAnimation) {
      startAnimation();
    } else if (coordinates.length > 0) {
      const path = document.createElementNS(svgNS, "path");
      path.classList.add("last-path");
      let pathData = "";

      coordinates.forEach((coordinate, index) => {
        const x = coordinate.x + PIXEL_CENTER_START_X;
        const y = 240 - coordinate.z * 0.5775;

        if (index === 0) {
          pathData += `M ${x},${y} `;
        } else {
          pathData += `L ${x},${y} `;
        }
      });

      path.setAttribute("d", pathData);
      path.setAttribute("stroke", "rgb(255, 221, 0)");
      path.setAttribute("stroke-width", "2");
      path.setAttribute("fill", "none");

      // Draw the final circle
      const lastCoordinate = coordinates[coordinates.length - 1];
      const lastX = lastCoordinate.x + PIXEL_CENTER_START_X;
      const lastY = 240 - lastCoordinate.z * 0.5775;
      const radius = 5;

      const circle = document.createElementNS(svgNS, "circle");
      circle.classList.add("last-circle");
      circle.setAttribute("cx", lastX.toString());
      circle.setAttribute("cy", lastY.toString());
      circle.setAttribute("r", radius.toString());
      circle.setAttribute("fill", "rgb(255, 221, 0)");
      circle.setAttribute("stroke", "rgba(0, 0, 0, 0.75)");
      circle.setAttribute("stroke-width", "1.5");

      if (svg) {
        svg.appendChild(path);
        svg.appendChild(circle);
      }
    }

    // cleanup 함수
    return () => {
      cancelAnimationFrame(raf);
    };
  }, [shotDataList, userDistance]);

  const xAxisLines = Array.from({ length: 5 + 1 }, (_, index) => ({
    x: 240 - (240 / 6) * index,
  }));

  return (
    <>
      <div className="bg-transparent absolute z-10 my-[9.5px] flex h-[221px] w-[240px] flex-col items-center justify-between">
        <div className="text-[10px] font-extrabold text-gv-dark-gray-200">
          400
        </div>
        <div className="text-[10px] font-extrabold text-gv-dark-gray-200">
          200
        </div>
        <div className="text-[10px] font-extrabold text-gv-dark-gray-200">
          0
        </div>
      </div>
      <svg ref={svgRef} width={240} height={240}>
        {xAxisLines.map((line, index) => (
          <line
            key={index}
            x1={line.x}
            y1={0}
            x2={line.x}
            y2={240}
            stroke="#ccc"
            strokeWidth="1"
            strokeDasharray={index === 3 ? "none" : "2"}
          />
        ))}
      </svg>
    </>
  );
};
